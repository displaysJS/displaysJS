{"version":3,"sources":["node_modules/browser-pack/_prelude.js","displays.js","lib/display.js","lib/display_coordinator.js","lib/timeline.js"],"names":[],"mappings":"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","file":"../displays.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\"use strict\";\n\nconst Timeline = require(\"./lib/timeline.js\");\nconst DisplayCoordinator = require(\"./lib/display_coordinator.js\");\nconst Display = require(\"./lib/display.js\");\n\n(function() {\n  var root = typeof self == 'object' && self.self === self && self ||\n            typeof global == 'object' && global.global === global && global ||\n            this ||\n            {};\n  var isBrowser = ('navigator' in root);\n\n  if (isBrowser) {\n    window.Timeline = Timeline;\n    window.DisplayCoordinator = DisplayCoordinator;\n    window.Display = Display;\n  }\n}).call(this);\n","\"use strict\";\nconst Timeline = require(\"./timeline.js\")\nconst MODES = {NORMAL:0, USER:1};\n\nclass Display {\n    constructor(args) {\n        this.context = args.context || undefined;\n        this.name = args.name || \"undefined\";\n        this.timeline = new Timeline({name: this.name + \"-timeline\",\n                                      treshold: args.timeline_treshold});\n        this.primary_display = args.primary_display || false;\n        this.mode = MODES.NORMAL;\n        this.m_ready = false;\n        if (this.context != undefined) {\n          this.context.emitter.on(\"tick\", handleTick);\n        }\n    }\n    toString() {\n        return '(' + this.name + ')';\n    }\n    ready() {this.m_ready;}\n    setCoordinatorTicker(tick_func) {\n      this.coordinator_ticker = tick_func;\n    }\n    isPrimaryDisplay() {\n      if (this.primary_display) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n    tick(){\n      if (this.isPrimaryDisplay) {\n        this.coordinator_ticker();\n      }\n    }\n    enableUserMode() { return this.mode = MODES.USER;}\n    releaseUserMode() {return this.mode = MODES.NORMAL;}\n    isInUserMode(){\n      if (this.mode == MODES.USER) {\n        return true;\n      }\n      return false;\n    }\n    handleTick() {}\n    render() {}\n    start() {}\n    pause() {}\n}\nmodule.exports = Display;\n","\"use strict\";\n\nvar hello = function () {\n  console.log(\"Hello world\");\n}\nmodule.exports = hello;\n","\"use strict\";\nconst NOT_FOUND = \"NOTFOUND\";\n\nclass TimeAction {\n    constructor(func, args, name=\"undefined\") {\n        this.action = func;\n        this.args = args;\n        this.name = name;\n    }\n    toString() {\n        return 'TimeAction:(' + this.name + ')';\n    }\n    trigger(){\n      this.action.apply(this, this.args);\n    }\n}\n\nclass Timeline {\n    constructor(args) {\n        this.time_actions = {};\n        this.name = args.name || \"undefined\";\n        this.treshold = args.treshold || 5;\n    }\n    toString() {\n        return '(' + this.name + ')';\n    }\n    addTimeAction(time, action, args=[], name=\"undefined\"){\n      if( !(Object.prototype.toString.call( args ) === '[object Array]') ) {\n          args = [args];\n      }\n      this.time_actions[time] = new TimeAction(action, args, name);\n    }\n    callTimeAction(time){\n      if (this.time_actions.hasOwnProperty(time)) {\n        this.time_actions[time].trigger()\n      }\n    }\n    callNearestTimeAction(time){\n      var t;\n      if (this.time_actions.hasOwnProperty(time)) {\n        t = time;\n      } else {\n       t = this.getNearestTime(time);\n      }\n\n      if (!(t==NOT_FOUND) && this.time_actions.hasOwnProperty(t)) {\n        this.time_actions[t].trigger()\n      }\n    }\n    getNearestTime(time){\n      for (var i = 1; i < this.treshold; i++) {\n        if (this.time_actions.hasOwnProperty(time+i)) {\n          return time+1;\n        }else if (this.time_actions.hasOwnProperty(time-i)) {\n          return time-1;\n        }\n      }\n      return NOT_FOUND;\n    }\n}\nmodule.exports = Timeline;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkaXNwbGF5cy5qcyIsImxpYi9kaXNwbGF5LmpzIiwibGliL2Rpc3BsYXlfY29vcmRpbmF0b3IuanMiLCJsaWIvdGltZWxpbmUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUE7Ozs7Ozs7Ozs7QUFFQSxJQUFNLFdBQVcsUUFBakIsQUFBaUIsQUFBUTtBQUN6QixJQUFNLHFCQUFxQixRQUEzQixBQUEyQixBQUFRO0FBQ25DLElBQU0sVUFBVSxRQUFoQixBQUFnQixBQUFROztBQUV4QixDQUFDLFlBQVcsQUFDVjtNQUFJLE9BQU8sUUFBQSxBQUFPLDZDQUFQLEFBQU8sVUFBUCxBQUFlLFlBQVksS0FBQSxBQUFLLFNBQWhDLEFBQXlDLFFBQXpDLEFBQWlELFFBQ2xELFFBQUEsQUFBTywrQ0FBUCxBQUFPLFlBQVAsQUFBaUIsWUFBWSxPQUFBLEFBQU8sV0FBcEMsQUFBK0MsVUFEOUMsQUFDd0QsVUFEeEQsQUFFRCxRQUZWLEFBR1UsQUFDVjtNQUFJLFlBQWEsZUFBakIsQUFBZ0MsQUFFaEM7O01BQUEsQUFBSSxXQUFXLEFBQ2I7V0FBQSxBQUFPLFdBQVAsQUFBa0IsQUFDbEI7V0FBQSxBQUFPLHFCQUFQLEFBQTRCLEFBQzVCO1dBQUEsQUFBTyxVQUFQLEFBQWlCLEFBQ2xCO0FBQ0Y7QUFaRCxHQUFBLEFBWUc7Ozs7O0FDbEJIOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQSxJQUFNLFdBQVcsUUFBakIsQUFBaUIsQUFBUTtBQUN6QixJQUFNLFFBQVEsRUFBQyxRQUFELEFBQVEsR0FBRyxNQUF6QixBQUFjLEFBQWdCOztJLEFBRXhCLHNCQUNGO21CQUFBLEFBQVksTUFBTTswQkFDZDs7U0FBQSxBQUFLLFVBQVUsS0FBQSxBQUFLLFdBQXBCLEFBQStCLEFBQy9CO1NBQUEsQUFBSyxPQUFPLEtBQUEsQUFBSyxRQUFqQixBQUF5QixBQUN6QjtTQUFBLEFBQUssV0FBVyxJQUFBLEFB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TCxBQUFrQixlQUF0QixBQUFJLEFBQWlDLE9BQU8sQUFDMUM7YUFBQSxBQUFLLGFBQUwsQUFBa0IsTUFBbEIsQUFBd0IsQUFDekI7QUFDRjs7OzswQyxBQUNxQixNQUFLLEFBQ3pCO1VBQUEsQUFBSSxBQUNKO1VBQUksS0FBQSxBQUFLLGFBQUwsQUFBa0IsZUFBdEIsQUFBSSxBQUFpQyxPQUFPLEFBQzFDO1lBQUEsQUFBSSxBQUNMO0FBRkQsYUFFTyxBQUNOO1lBQUksS0FBQSxBQUFLLGVBQVQsQUFBSSxBQUFvQixBQUN4QjtBQUVEOztVQUFJLEVBQUUsS0FBRixBQUFLLGNBQWMsS0FBQSxBQUFLLGFBQUwsQUFBa0IsZUFBekMsQUFBdUIsQUFBaUMsSUFBSSxBQUMxRDthQUFBLEFBQUssYUFBTCxBQUFrQixHQUFsQixBQUFxQixBQUN0QjtBQUNGOzs7O21DLEFBQ2MsTUFBSyxBQUNsQjtXQUFLLElBQUksSUFBVCxBQUFhLEdBQUcsSUFBSSxLQUFwQixBQUF5QixVQUF6QixBQUFtQyxLQUFLLEFBQ3RDO1lBQUksS0FBQSxBQUFLLGFBQUwsQUFBa0IsZUFBZSxPQUFyQyxBQUFJLEFBQXNDLElBQUksQUFDNUM7aUJBQU8sT0FBUCxBQUFZLEFBQ2I7QUFGRCxlQUVNLElBQUksS0FBQSxBQUFLLGFBQUwsQUFBa0IsZUFBZSxPQUFyQyxBQUFJLEFBQXNDLElBQUksQUFDbEQ7aUJBQU8sT0FBUCxBQUFZLEFBQ2I7QUFDRjtBQUNEO2FBQUEsQUFBTyxBQUNSOzs7Ozs7O0FBRUwsT0FBQSxBQUFPLFVBQVAsQUFBaUIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IFRpbWVsaW5lID0gcmVxdWlyZShcIi4vbGliL3RpbWVsaW5lLmpzXCIpO1xuY29uc3QgRGlzcGxheUNvb3JkaW5hdG9yID0gcmVxdWlyZShcIi4vbGliL2Rpc3BsYXlfY29vcmRpbmF0b3IuanNcIik7XG5jb25zdCBEaXNwbGF5ID0gcmVxdWlyZShcIi4vbGliL2Rpc3BsYXkuanNcIik7XG5cbihmdW5jdGlvbigpIHtcbiAgdmFyIHJvb3QgPSB0eXBlb2Ygc2VsZiA9PSAnb2JqZWN0JyAmJiBzZWxmLnNlbGYgPT09IHNlbGYgJiYgc2VsZiB8fFxuICAgICAgICAgICAgdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWwuZ2xvYmFsID09PSBnbG9iYWwgJiYgZ2xvYmFsIHx8XG4gICAgICAgICAgICB0aGlzIHx8XG4gICAgICAgICAgICB7fTtcbiAgdmFyIGlzQnJvd3NlciA9ICgnbmF2aWdhdG9yJyBpbiByb290KTtcblxuICBpZiAoaXNCcm93c2VyKSB7XG4gICAgd2luZG93LlRpbWVsaW5lID0gVGltZWxpbmU7XG4gICAgd2luZG93LkRpc3BsYXlDb29yZGluYXRvciA9IERpc3BsYXlDb29yZGluYXRvcjtcbiAgICB3aW5kb3cuRGlzcGxheSA9IERpc3BsYXk7XG4gIH1cbn0pLmNhbGwodGhpcyk7XG4iLCJcInVzZSBzdHJpY3RcIjtcbmNvbnN0IFRpbWVsaW5lID0gcmVxdWlyZShcIi4vdGltZWxpbmUuanNcIilcbmNvbnN0IE1PREVTID0ge05PUk1BTDowLCBVU0VSOjF9O1xuXG5jbGFzcyBEaXNwbGF5IHtcbiAgICBjb25zdHJ1Y3RvcihhcmdzKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGFyZ3MuY29udGV4dCB8fCB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubmFtZSA9IGFyZ3MubmFtZSB8fCBcInVuZGVmaW5lZFwiO1xuICAgICAgICB0aGlzLnRpbWVsaW5lID0gbmV3IFRpbWVsaW5lKHtuYW1lOiB0aGlzLm5hbWUgKyBcIi10aW1lbGluZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmVzaG9sZDogYXJncy50aW1lbGluZV90cmVzaG9sZH0pO1xuICAgICAgICB0aGlzLnByaW1hcnlfZGlzcGxheSA9IGFyZ3MucHJpbWFyeV9kaXNwbGF5IHx8IGZhbHNlO1xuICAgICAgICB0aGlzLm1vZGUgPSBNT0RFUy5OT1JNQUw7XG4gICAgICAgIHRoaXMubV9yZWFkeSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5jb250ZXh0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMuY29udGV4dC5lbWl0dGVyLm9uKFwidGlja1wiLCBoYW5kbGVUaWNrKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuICcoJyArIHRoaXMubmFtZSArICcpJztcbiAgICB9XG4gICAgcmVhZHkoKSB7dGhpcy5tX3JlYWR5O31cbiAgICBzZXRDb29yZGluYXRvclRpY2tlcih0aWNrX2Z1bmMpIHtcbiAgICAgIHRoaXMuY29vcmRpbmF0b3JfdGlja2VyID0gdGlja19mdW5jO1xuICAgIH1cbiAgICBpc1ByaW1hcnlEaXNwbGF5KCkge1xuICAgICAgaWYgKHRoaXMucHJpbWFyeV9kaXNwbGF5KSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICB0aWNrKCl7XG4gICAgICBpZiAodGhpcy5pc1ByaW1hcnlEaXNwbGF5KSB7XG4gICAgICAgIHRoaXMuY29vcmRpbmF0b3JfdGlja2VyKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGVuYWJsZVVzZXJNb2RlKCkgeyByZXR1cm4gdGhpcy5tb2RlID0gTU9ERVMuVVNFUjt9XG4gICAgcmVsZWFzZVVzZXJNb2RlKCkge3JldHVybiB0aGlzLm1vZGUgPSBNT0RFUy5OT1JNQUw7fVxuICAgIGlzSW5Vc2VyTW9kZSgpe1xuICAgICAgaWYgKHRoaXMubW9kZSA9PSBNT0RFUy5VU0VSKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBoYW5kbGVUaWNrKCkge31cbiAgICByZW5kZXIoKSB7fVxuICAgIHN0YXJ0KCkge31cbiAgICBwYXVzZSgpIHt9XG59XG5tb2R1bGUuZXhwb3J0cyA9IERpc3BsYXk7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIGhlbGxvID0gZnVuY3Rpb24gKCkge1xuICBjb25zb2xlLmxvZyhcIkhlbGxvIHdvcmxkXCIpO1xufVxubW9kdWxlLmV4cG9ydHMgPSBoZWxsbztcbiIsIlwidXNlIHN0cmljdFwiO1xuY29uc3QgTk9UX0ZPVU5EID0gXCJOT1RGT1VORFwiO1xuXG5jbGFzcyBUaW1lQWN0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihmdW5jLCBhcmdzLCBuYW1lPVwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgdGhpcy5hY3Rpb24gPSBmdW5jO1xuICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuICdUaW1lQWN0aW9uOignICsgdGhpcy5uYW1lICsgJyknO1xuICAgIH1cbiAgICB0cmlnZ2VyKCl7XG4gICAgICB0aGlzLmFjdGlvbi5hcHBseSh0aGlzLCB0aGlzLmFyZ3MpO1xuICAgIH1cbn1cblxuY2xhc3MgVGltZWxpbmUge1xuICAgIGNvbnN0cnVjdG9yKGFyZ3MpIHtcbiAgICAgICAgdGhpcy50aW1lX2FjdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5uYW1lID0gYXJncy5uYW1lIHx8IFwidW5kZWZpbmVkXCI7XG4gICAgICAgIHRoaXMudHJlc2hvbGQgPSBhcmdzLnRyZXNob2xkIHx8IDU7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gJygnICsgdGhpcy5uYW1lICsgJyknO1xuICAgIH1cbiAgICBhZGRUaW1lQWN0aW9uKHRpbWUsIGFjdGlvbiwgYXJncz1bXSwgbmFtZT1cInVuZGVmaW5lZFwiKXtcbiAgICAgIGlmKCAhKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCggYXJncyApID09PSAnW29iamVjdCBBcnJheV0nKSApIHtcbiAgICAgICAgICBhcmdzID0gW2FyZ3NdO1xuICAgICAgfVxuICAgICAgdGhpcy50aW1lX2FjdGlvbnNbdGltZV0gPSBuZXcgVGltZUFjdGlvbihhY3Rpb24sIGFyZ3MsIG5hbWUpO1xuICAgIH1cbiAgICBjYWxsVGltZUFjdGlvbih0aW1lKXtcbiAgICAgIGlmICh0aGlzLnRpbWVfYWN0aW9ucy5oYXNPd25Qcm9wZXJ0eSh0aW1lKSkge1xuICAgICAgICB0aGlzLnRpbWVfYWN0aW9uc1t0aW1lXS50cmlnZ2VyKClcbiAgICAgIH1cbiAgICB9XG4gICAgY2FsbE5lYXJlc3RUaW1lQWN0aW9uKHRpbWUpe1xuICAgICAgdmFyIHQ7XG4gICAgICBpZiAodGhpcy50aW1lX2FjdGlvbnMuaGFzT3duUHJvcGVydHkodGltZSkpIHtcbiAgICAgICAgdCA9IHRpbWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgIHQgPSB0aGlzLmdldE5lYXJlc3RUaW1lKHRpbWUpO1xuICAgICAgfVxuXG4gICAgICBpZiAoISh0PT1OT1RfRk9VTkQpICYmIHRoaXMudGltZV9hY3Rpb25zLmhhc093blByb3BlcnR5KHQpKSB7XG4gICAgICAgIHRoaXMudGltZV9hY3Rpb25zW3RdLnRyaWdnZXIoKVxuICAgICAgfVxuICAgIH1cbiAgICBnZXROZWFyZXN0VGltZSh0aW1lKXtcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy50cmVzaG9sZDsgaSsrKSB7XG4gICAgICAgIGlmICh0aGlzLnRpbWVfYWN0aW9ucy5oYXNPd25Qcm9wZXJ0eSh0aW1lK2kpKSB7XG4gICAgICAgICAgcmV0dXJuIHRpbWUrMTtcbiAgICAgICAgfWVsc2UgaWYgKHRoaXMudGltZV9hY3Rpb25zLmhhc093blByb3BlcnR5KHRpbWUtaSkpIHtcbiAgICAgICAgICByZXR1cm4gdGltZS0xO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gTk9UX0ZPVU5EO1xuICAgIH1cbn1cbm1vZHVsZS5leHBvcnRzID0gVGltZWxpbmU7XG4iXX0="}